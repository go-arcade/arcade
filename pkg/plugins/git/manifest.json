{
  "name": "git",
  "version": "1.0.0",
  "description": "Git 版本控制插件，支持克隆、检出、拉取、状态查询、提交历史等操作，适用于 CI/CD 流程中的代码仓库管理",
  "author": "Arcade Team <support@go-arcade.io>",
  "homepage": "https://github.com/go-arcade/arcade",
  "repository": "https://github.com/go-arcade/arcade",
  "pluginType": "source",
  "entryPoint": "git",
  "dependencies": [],
  "configSchema": {
    "type": "object",
    "properties": {
      "git_path": {
        "type": "string",
        "description": "Git 可执行文件的路径",
        "default": "git",
        "examples": ["git", "/usr/bin/git", "/usr/local/bin/git"]
      },
      "timeout": {
        "type": "integer",
        "description": "操作超时时间（秒），0 表示无限制",
        "default": 300,
        "minimum": 0
      },
      "work_dir": {
        "type": "string",
        "description": "默认工作目录",
        "default": ""
      },
      "user_name": {
        "type": "string",
        "description": "默认 Git 用户名（用于提交）",
        "default": ""
      },
      "user_email": {
        "type": "string",
        "description": "默认 Git 用户邮箱（用于提交）",
        "default": ""
      },
      "shallow": {
        "type": "boolean",
        "description": "是否默认使用浅克隆",
        "default": false
      },
      "depth": {
        "type": "integer",
        "description": "浅克隆的深度",
        "default": 1,
        "minimum": 1
      }
    },
    "required": []
  },
  "actionsSchema": {
    "clone": {
      "description": "克隆 Git 仓库",
      "args": {
        "type": "object",
        "properties": {
          "repo": {
            "type": "string",
            "description": "仓库 URL",
            "examples": [
              "https://github.com/user/repo.git",
              "git@github.com:user/repo.git",
              "https://gitlab.com/user/repo.git"
            ]
          },
          "branch": {
            "type": "string",
            "description": "要克隆的分支名称（可选）"
          },
          "tag": {
            "type": "string",
            "description": "要克隆的标签名称（可选）"
          },
          "commit": {
            "type": "string",
            "description": "要检出的提交 SHA（可选）"
          },
          "path": {
            "type": "string",
            "description": "目标路径（可选，默认为仓库名称）"
          },
          "shallow": {
            "type": "boolean",
            "description": "是否使用浅克隆（覆盖配置）"
          },
          "depth": {
            "type": "integer",
            "description": "浅克隆深度（覆盖配置）",
            "minimum": 1
          },
          "auth": {
            "type": "object",
            "description": "认证信息",
            "properties": {
              "username": {
                "type": "string",
                "description": "用户名"
              },
              "password": {
                "type": "string",
                "description": "密码"
              },
              "token": {
                "type": "string",
                "description": "访问令牌"
              },
              "ssh_key": {
                "type": "string",
                "description": "SSH 私钥"
              }
            }
          },
          "env": {
            "type": "object",
            "description": "额外的环境变量",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["repo"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "stdout": {
            "type": "string",
            "description": "标准输出"
          },
          "stderr": {
            "type": "string",
            "description": "标准错误"
          },
          "exit_code": {
            "type": "integer",
            "description": "退出代码"
          },
          "duration_ms": {
            "type": "integer",
            "description": "执行时长（毫秒）"
          },
          "success": {
            "type": "boolean",
            "description": "是否执行成功"
          },
          "path": {
            "type": "string",
            "description": "克隆后的路径"
          },
          "error": {
            "type": "string",
            "description": "错误信息（如果有）"
          }
        }
      }
    },
    "checkout": {
      "description": "检出分支、标签或提交",
      "args": {
        "type": "object",
        "properties": {
          "ref": {
            "type": "string",
            "description": "分支、标签或提交 SHA",
            "examples": ["main", "v1.0.0", "abc123def"]
          },
          "path": {
            "type": "string",
            "description": "仓库路径（必需）"
          },
          "force": {
            "type": "boolean",
            "description": "强制检出（丢弃本地更改）",
            "default": false
          },
          "create": {
            "type": "boolean",
            "description": "如果分支不存在则创建",
            "default": false
          },
          "env": {
            "type": "object",
            "description": "额外的环境变量",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["ref", "path"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "stdout": {"type": "string"},
          "stderr": {"type": "string"},
          "exit_code": {"type": "integer"},
          "duration_ms": {"type": "integer"},
          "success": {"type": "boolean"},
          "error": {"type": "string"}
        }
      }
    },
    "pull": {
      "description": "从远程拉取最新更改",
      "args": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "仓库路径（必需）"
          },
          "branch": {
            "type": "string",
            "description": "要拉取的分支（可选，默认为当前分支）"
          },
          "remote": {
            "type": "string",
            "description": "远程名称（可选，默认为 origin）"
          },
          "rebase": {
            "type": "boolean",
            "description": "使用 rebase 而不是 merge",
            "default": false
          },
          "env": {
            "type": "object",
            "description": "额外的环境变量",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["path"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "stdout": {"type": "string"},
          "stderr": {"type": "string"},
          "exit_code": {"type": "integer"},
          "duration_ms": {"type": "integer"},
          "success": {"type": "boolean"},
          "error": {"type": "string"}
        }
      }
    },
    "status": {
      "description": "查看仓库状态",
      "args": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "仓库路径（必需）"
          },
          "short": {
            "type": "boolean",
            "description": "使用简短格式输出",
            "default": false
          },
          "env": {
            "type": "object",
            "description": "额外的环境变量",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["path"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "stdout": {"type": "string"},
          "stderr": {"type": "string"},
          "exit_code": {"type": "integer"},
          "duration_ms": {"type": "integer"},
          "success": {"type": "boolean"},
          "error": {"type": "string"}
        }
      }
    },
    "log": {
      "description": "查看提交历史",
      "args": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "仓库路径（必需）"
          },
          "ref": {
            "type": "string",
            "description": "分支/标签/提交（可选）"
          },
          "limit": {
            "type": "integer",
            "description": "限制提交数量",
            "minimum": 1
          },
          "since": {
            "type": "string",
            "description": "显示此日期之后的提交",
            "examples": ["2024-01-01", "2 weeks ago", "2024-01-01 00:00:00"]
          },
          "until": {
            "type": "string",
            "description": "显示此日期之前的提交"
          },
          "author": {
            "type": "string",
            "description": "按作者过滤"
          },
          "env": {
            "type": "object",
            "description": "额外的环境变量",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["path"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "stdout": {"type": "string"},
          "stderr": {"type": "string"},
          "exit_code": {"type": "integer"},
          "duration_ms": {"type": "integer"},
          "success": {"type": "boolean"},
          "error": {"type": "string"}
        }
      }
    },
    "branch": {
      "description": "列出分支",
      "args": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "仓库路径（必需）"
          },
          "remote": {
            "type": "boolean",
            "description": "列出远程分支",
            "default": false
          },
          "all": {
            "type": "boolean",
            "description": "列出所有分支（本地和远程）",
            "default": false
          },
          "env": {
            "type": "object",
            "description": "额外的环境变量",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["path"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "stdout": {"type": "string"},
          "stderr": {"type": "string"},
          "exit_code": {"type": "integer"},
          "duration_ms": {"type": "integer"},
          "success": {"type": "boolean"},
          "error": {"type": "string"}
        }
      }
    },
    "tag": {
      "description": "列出标签",
      "args": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "仓库路径（必需）"
          },
          "sort": {
            "type": "string",
            "description": "排序方式",
            "examples": ["version", "date", "-version", "-date"]
          },
          "env": {
            "type": "object",
            "description": "额外的环境变量",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": ["path"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "stdout": {"type": "string"},
          "stderr": {"type": "string"},
          "exit_code": {"type": "integer"},
          "duration_ms": {"type": "integer"},
          "success": {"type": "boolean"},
          "error": {"type": "string"}
        }
      }
    }
  },
  "icon": "https://cdn.example.com/icons/git.png",
  "tags": ["git", "version-control", "source", "scm", "repository"],
  "minVersion": "1.0.0",
  "resources": {
    "cpu": "100m",
    "memory": "128Mi",
    "disk": "100Mi"
  },
  "examples": [
    {
      "name": "克隆仓库",
      "description": "克隆一个 Git 仓库到指定目录",
      "config": {},
      "action": "clone",
      "args": {
        "repo": "https://github.com/user/repo.git",
        "branch": "main",
        "path": "/workspace/repo"
      }
    },
    {
      "name": "检出分支",
      "description": "检出指定的分支",
      "config": {},
      "action": "checkout",
      "args": {
        "ref": "develop",
        "path": "/workspace/repo"
      }
    },
    {
      "name": "拉取更新",
      "description": "从远程拉取最新更改",
      "config": {},
      "action": "pull",
      "args": {
        "path": "/workspace/repo",
        "branch": "main"
      }
    },
    {
      "name": "查看状态",
      "description": "查看仓库的当前状态",
      "config": {},
      "action": "status",
      "args": {
        "path": "/workspace/repo",
        "short": true
      }
    },
    {
      "name": "查看提交历史",
      "description": "查看最近的提交历史",
      "config": {},
      "action": "log",
      "args": {
        "path": "/workspace/repo",
        "limit": 10
      }
    }
  ],
  "security": {
    "capabilities": ["exec", "file_read", "file_write", "network"],
    "recommendations": [
      "确保 Git 可执行文件路径安全",
      "使用安全的认证方式（推荐使用 SSH 密钥或访问令牌）",
      "不要在配置中硬编码敏感信息",
      "限制插件只能访问特定目录",
      "为操作设置合理的超时时间"
    ]
  }
}
